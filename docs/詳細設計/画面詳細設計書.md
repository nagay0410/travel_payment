# 画面詳細設計書

## 1. 共通UIコンポーネント (Shared)
Angular Material をベースに、以下のプロジェクト共通コンポーネントを定義する。

- `TripCardComponent`: 旅行一覧用のサマリーカード。
- `MemberAvatarComponent`: ユーザーアイコン（参加者リスト用）。
- `CurrencyInputComponent`: 金額入力用（通貨記号・フォーマット済み）。
- `StatusBadgeComponent`: 旅行や支払いのステータス表示用チップ。

## 2. 画面詳細仕様

### 2.1 旅行ダッシュボード (SCR-05)
- **コンポーネント構成**:
  - `TripDashboardComponent` (Container)
    - `TripHeaderComponent`: 旅行名、期間、進捗バー表示。
    - `MemberListSidebarComponent`: 参加者一覧。
    - `ExpenseSummaryComponent`: 自己負担額・精算予定額表示。
- **状態管理 (Store/Service)**:
  - `currentTrip$`: 現在表示中の旅行オブジェクト。
- **主要な処理**:
  - `OnInit`: `ActivatedRoute` から `tripId` を取得し、`TripService.getById(tripId)` を呼び出す。
- **API 呼び出しタイミング**:
  - 画面遷移時（一括取得）。

### 2.2 支払い登録・編集 (SCR-07)
- **コンポーネント構成**:
  - `PaymentFormComponent`
    - `CategorySelectComponent`: カテゴリ一覧（API経由）。
    - `ImageUploadComponent`: レシート写真撮影・選択。
- **バリデーション (Angular Reactive Forms)**:
  - 金額: `Validators.required`, `Validators.min(1)`
  - 項目名: `Validators.required`, `Validators.maxLength(100)`
- **主要な処理**:
  - 保存ボタン押下: `form.valid` を確認後、`PaymentService.create()` または `update()` を呼び出す。

### 2.3 精算計算・実行 (SCR-08)
- **コンポーネント構成**:
  - `SettlementComponent`
    - `SettlementListComponent`: 貸し借りリスト。
    - `ConfirmSettlementDialogComponent`: 精算完了確認。
- **主要な処理**:
  - 精算ボタン押下: リストから特定の項目を選択し、`SettlementService.complete()` を呼び出す。

## 3. アプリケーション共通状態
- `AuthService`: `currentUser$`, `isAuthenticated$` を RxJS `BehaviorSubject` で管理。
- `LoadingInterceptor`: HTTPリクエスト中のスピナー表示を全局的に制御。
- `NotificationService`: スナックバーによる成功・エラー通知の統一。
